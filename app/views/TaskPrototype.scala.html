@*
 * Copyright (c) Salesforce.com, inc. 2017
 *@

@this(main: Main)

@(projectName: String, taskPrototype: models.Task.Prototype)

@main("Task") {

    @projectName

    @for(form <- taskPrototype.form) {
        <div id="form"></div>
        <script>
            const form = @Html(form.toString());
            form.options.form.buttons.submit.click = function() {
                if (this.isValid(true)) {
                    const config = {
                        data: JSON.stringify(this.getValue()),
                        contentType: "application/json"
                    };
                    this.ajaxSubmit(config).done(function(projectRequest) {
                        // todo: send to project request page
                        window.location = "/";
                    });
                }
                else {
                    console.error(this.getValue());
                }
            };

            $("#form").alpaca(form);
        </script>
    }

}
