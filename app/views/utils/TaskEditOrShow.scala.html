@*
 * Copyright (c) Salesforce.com, inc. 2018
 *@

@this(taskEditView: TaskEdit, taskShowView: TaskShow)

@(task: models.Task, commentCount: Long, canEdit: Boolean, isAdmin: Boolean)(implicit request: RequestHeader)

@panelType = {
    @task.state match {
        case models.State.InProgress => {
            panel-default
        }
        case models.State.Completed => {
            panel-success
        }
        case _ => {
            panel-warning
        }
    }
}

<div class="panel @panelType">
    <div class="panel-heading clearfix">
        <h3 class="panel-title pull-left">@task.prototype.label</h3>
        <div class="pull-right">
            <div class="row">
                <div class="col-md-9">
                    <button type="button" class="btn btn-default btn-sm pull-right" data-toggle="modal" data-target="#commentsModal" data-requestslug="@task.requestSlug" data-taskid="@task.id">
                        <span class="glyphicon glyphicon-comment"></span>
                        @commentCount Comments
                    </button>
                </div>
                @if(isAdmin) {
                    <div class="col-md-3">
                        <button type="button" class="btn btn-danger btn-sm pull-right" data-toggle="modal" data-target="#confirmModal" data-action="delete" data-url="@helper.CSRF(routes.Application.deleteTask(task.requestSlug, task.id))">
                            <span class="glyphicon glyphicon-remove"></span>
                        </button>
                    </div>
                }
            </div>
        </div>
    </div>

    @task.state match {
        case models.State.InProgress if canEdit => {
            @taskEditView(Right(task))
        }
        case _ => {
            @taskShowView(task)
        }
    }
</div>
